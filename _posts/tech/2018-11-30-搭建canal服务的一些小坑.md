---
layout: post
title:  "搭建canal服务的一些小坑"
date:   2018-11-30
tags:
        - 技术
        - canal
        - mysql
        - binlog
        
---


### 1. V1.1.2 版本将 mq.yml 配置合到了 canal.properties 里， 在代码上未妥善处理，

HA+MQ模式下, 如果canal server 发生了主从切换,  虽然从服务的instance能正常接管binlog的拉取处理, 但不能将取得的binlog发往MQ服务.
最新代码中解决
详见 [canal issues #1229](https://github.com/alibaba/canal/issues/1229)



### 2. V1.1.2 release 的 canal.adapter-1.1.2.tar.gz,  spring jar包版本有问题,

client-adapter 启动后报错 java.lang.ClassNotFoundException: org.springframework.core.KotlinDetector

需要把 lib里 3.2.18.RELEASE版本的 spring jar包 换成 5.0.5.RELEASE的

详见 [canal issues #1234](https://github.com/alibaba/canal/issues/1234)
